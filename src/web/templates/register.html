<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enregistrement de visage</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .registration-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 20px;
            background: #f9fafb;
            border-radius: 8px;
        }
        
        .step {
            flex: 1;
            text-align: center;
            padding: 10px;
            position: relative;
        }
        
        .step:not(:last-child)::after {
            content: '‚Üí';
            position: absolute;
            right: -20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 24px;
            color: #9ca3af;
        }
        
        .step.active {
            color: #667eea;
            font-weight: bold;
        }
        
        .step.completed {
            color: #10b981;
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e5e7eb;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        #name-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #667eea;
            border-radius: 6px;
            font-size: 16px;
            margin-bottom: 15px;
        }
        
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .photo-slot {
            aspect-ratio: 1;
            border: 2px dashed #9ca3af;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #9ca3af;
        }
        
        .photo-slot.captured {
            border-color: #10b981;
            background: #d1fae5;
            color: #10b981;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üì∏ Enregistrement de nouveau visage</h1>
            <a href="/" class="btn btn-secondary" style="display: inline-block; margin-top: 10px;">‚Üê Retour</a>
        </header>

        <main>
            <!-- √âtapes -->
            <div class="registration-steps">
                <div class="step" id="step-1">
                    <div>üìù</div>
                    <div>Entrer le nom</div>
                </div>
                <div class="step" id="step-2">
                    <div>üì∏</div>
                    <div>Capturer 5 photos</div>
                </div>
                <div class="step" id="step-3">
                    <div>üíæ</div>
                    <div>Sauvegarder</div>
                </div>
            </div>

            <!-- √âtape 1 : Nom -->
            <div id="name-section">
                <h3>√âtape 1 : Entrez votre nom</h3>
                <input type="text" id="name-input" placeholder="Votre nom..." autofocus>
                <button id="start-btn" class="btn btn-primary">D√©marrer l'enregistrement</button>
            </div>

            <!-- √âtape 2 : Capture -->
            <div id="capture-section" style="display: none;">
                <h3>√âtape 2 : Capturez 5 photos de votre visage</h3>
                
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill" style="width: 0%;">0/5</div>
                </div>

                <div class="photo-grid">
                    <div class="photo-slot" id="slot-1">1</div>
                    <div class="photo-slot" id="slot-2">2</div>
                    <div class="photo-slot" id="slot-3">3</div>
                    <div class="photo-slot" id="slot-4">4</div>
                    <div class="photo-slot" id="slot-5">5</div>
                </div>

                <div class="video-container">
                    <img id="registration-feed" src="" alt="Flux vid√©o" class="video-stream">
                </div>

               <div class="controls">
    <button id="auto-capture-btn" class="btn btn-primary">
        ü§ñ CAPTURE AUTOMATIQUE
    </button>
    <button id="cancel-btn" class="btn btn-secondary">‚ùå Annuler</button>
</div>

<div class="info-card" style="margin-top: 20px;">
    <h4>Instructions :</h4>
    <ul>
        <li>Cliquez sur "Capture automatique"</li>
        <li>Restez face √† la cam√©ra sans bouger</li>
        <li>Le syst√®me capture automatiquement 5 photos</li>
        <li>Variez l√©g√®rement l'angle entre chaque photo</li>
    </ul>
</div>

            <!-- √âtape 3 : Sauvegarde -->
            <div id="save-section" style="display: none;">
                <h3>‚úÖ Toutes les photos captur√©es !</h3>
                <p>Cliquez sur le bouton ci-dessous pour finaliser l'enregistrement.</p>
                <button id="save-btn" class="btn btn-primary">üíæ Enregistrer le visage</button>
            </div>

            <!-- Message de succ√®s -->
            <div id="success-section" style="display: none;">
                <div class="info-card" style="background: #d1fae5; border-color: #10b981;">
                    <h3 style="color: #10b981;">üéâ Enregistrement r√©ussi !</h3>
                    <p id="success-message"></p>
                    <a href="/" class="btn btn-primary" style="margin-top: 15px;">Retour √† l'accueil</a>
                    <button id="new-registration-btn" class="btn btn-secondary" style="margin-top: 15px;">Enregistrer une autre personne</button>
                </div>
            </div>
        </main>
    </div>

    <script src="{{ url_for('static', filename='js/register.js') }}"></script>
</body>
</html>